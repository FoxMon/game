package multi;

import java.util.HashMap;
import java.util.HashSet;
import java.util.Map;
import java.util.Set;
import java.io.File;
import java.net.SocketAddress;
import common.*;

public class UserAccountPool {

	private Map<String, Account> accountMap;
	private Set<Account> currentUser;
	private File address;
	
	public UserAccountPool() {
		// loading server file...
		accountMap = new HashMap<>();
		currentUser = new HashSet<>();
	}
	
	// add user information control method
	public String create(String id, String pass, String name) {
		if(accountMap.containsKey(id)) {
            return "false# already exist...";
        } else {
            accountMap.put(id, new Account(id, pass, name));
            System.out.println(accountMap);
            
            return "true";
        }
    }
	
	public String login(String id, String pass, SocketAddress sa) {
		if(accountMap.containsKey(id)) {
			
            if(!currentUser.contains(new Account(id, "", ""))) {
            	
                if(accountMap.get(id).getPass().equals(pass)) {
                    currentUser.add(accountMap.get(id));
                    accountMap.get(id).setSocketAddress(sa);
                    return "true";
                }else {
                    return "false# not correct password.";
                }
                
            } else {
                return "false# now login id.";
            }
        } else {
            return "false# not exist id.";
        }
	}

	// getter and setter
	public Map<String, Account> getAccountMap() {
		return accountMap;
	}

	public void setAccountMap(Map<String, Account> accountMap) {
		this.accountMap = accountMap;
	}

	public Set<Account> getCurrentUser() {
		return currentUser;
	}

	public void setCurrentUser(Set<Account> currentUser) {
		this.currentUser = currentUser;
	}

	public File getAddress() {
		return address;
	}

	public void setAddress(File address) {
		this.address = address;
	}
	
}
